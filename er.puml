@startuml
skinparam titleBorderRoundCorner 15
skinparam titleBorderThickness 2
skinparam titleBorderColor red
skinparam titleBackgroundColor Aqua-CadetBlue
title HELPDesk DB ER diagram
' hide the spot
hide circle
' avoid problems with angled crows feet
skinparam linetype ortho
skinparam ClassHeaderBackgroundColor LightSteelBlue
skinparam classFontColor maroon
skinparam classFontSize 11
skinparam classFontName Aapex
skinparam NoteFontSize 9
skinparam LegendBackgroundColor GreenYellow
skinparam LegendBorderColor red
skinparam LegendFontSize 12

entity "USER" as user {
  *user_id : number <<generated>>
  --
  name : text
  surname : text
  ssologin : text
  email :  text
  *manager_id : number <<FK>>
}
note right: USER is joined with itself \nto get manager for current user
entity "ROLE" as role {
  *role_id : number <<generated>>
  --
  *user_id : number <<FK>>
  description : text
}
'note right: One of \n{USER, SUPERVISOR}}

entity "REQUEST" as request {
  *request_id : number <<generated>>
  --
  requesttime : datetime
  clientid : number
  narrative : text
  *user_id : number <<FK>>
}
note right: **clientid** is not FK \nbecause clients \nis not part of our DB

entity "INCIDENT" as incident {
  *incident_id : number <<generated>>
  --
  incidenttime : datetime
  service : text
  orderid : number
  *request_id : number <<FK>>
}
note right: **orderid** is not FK \nbecause orders \nis not part of our DB


user ||..|| role
user ||..|{ user
user ||..o{ request
request ||..o| incident

legend right
"||..|| - One-to-One"
"||..|{ - One-to-Many"
"||..o{ - Zero-to-Many"
"||..o| - Zero-to-One"
endlegend

@enduml